{"ast":null,"code":"import React,{useState,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ReplyList(_ref){let{messageId,onClose}=_ref;const[parentMessage,setParentMessage]=useState(null);const[replies,setReplies]=useState([]);const[newReply,setNewReply]=useState('');const apiKey=localStorage.getItem('api_key');// Define a function to fetch replies\nconst fetchReplies=()=>{if(!messageId)return;fetch(\"/api/messages/\".concat(messageId,\"/replies\"),{headers:{'API-Key':apiKey}}).then(response=>response.json()).then(data=>{setParentMessage(data.parentMessage);setReplies(data.replies);}).catch(error=>console.error('Error fetching replies:',error));};useEffect(()=>{fetchReplies();// Fetch replies initially\nconst intervalId=setInterval(fetchReplies,500);// Poll for new replies every 5000 ms\nreturn()=>clearInterval(intervalId);// Cleanup interval on component unmount\n},[messageId,apiKey]);// Re-run effect if messageId or apiKey changes\nconst handleSubmit=async e=>{e.preventDefault();if(!newReply.trim())return;try{const response=await fetch(\"/api/messages/\".concat(messageId,\"/replies\"),{method:'POST',headers:{'Content-Type':'application/json','API-Key':apiKey},body:JSON.stringify({message:newReply})});if(!response.ok){throw new Error('Failed to post reply');}setNewReply('');// Clear the reply input field\nfetchReplies();// Fetch the latest replies after posting a new one\n}catch(error){console.error('Error posting reply:',error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"reply-list\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"close-btn\",onClick:onClose,children:\"X\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"parent-message\",children:[/*#__PURE__*/_jsxs(\"strong\",{children:[parentMessage===null||parentMessage===void 0?void 0:parentMessage.name,\":\"]}),\" \",parentMessage===null||parentMessage===void 0?void 0:parentMessage.body]}),/*#__PURE__*/_jsx(\"div\",{className:\"replies\",children:replies.length>0?replies.map((reply,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"reply\",children:[/*#__PURE__*/_jsxs(\"strong\",{children:[reply.name,\":\"]}),\" \",reply.body]},index)):/*#__PURE__*/_jsx(\"p\",{children:\"No replies yet\"})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"reply-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newReply,onChange:e=>setNewReply(e.target.value),placeholder:\"Write a reply...\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Send\"})]})]});}export default ReplyList;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","ReplyList","_ref","messageId","onClose","parentMessage","setParentMessage","replies","setReplies","newReply","setNewReply","apiKey","localStorage","getItem","fetchReplies","fetch","concat","headers","then","response","json","data","catch","error","console","intervalId","setInterval","clearInterval","handleSubmit","e","preventDefault","trim","method","body","JSON","stringify","message","ok","Error","className","children","onClick","name","length","map","reply","index","onSubmit","type","value","onChange","target","placeholder"],"sources":["/Users/rdi28/Desktop/WebDev/FinalProject2/final-project-belay-ron-di28/app/src/ReplyList.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\n\nfunction ReplyList({ messageId, onClose }) {\n  const [parentMessage, setParentMessage] = useState(null);\n  const [replies, setReplies] = useState([]);\n  const [newReply, setNewReply] = useState('');\n\n  const apiKey = localStorage.getItem('api_key');\n\n  // Define a function to fetch replies\n  const fetchReplies = () => {\n      if (!messageId) return;\n\n      fetch(`/api/messages/${messageId}/replies`, {\n          headers: {\n              'API-Key': apiKey\n          },\n      })\n      .then(response => response.json())\n      .then(data => {\n          setParentMessage(data.parentMessage);\n          setReplies(data.replies);\n      })\n      .catch(error => console.error('Error fetching replies:', error));\n  };\n\n  useEffect(() => {\n      fetchReplies(); // Fetch replies initially\n\n      const intervalId = setInterval(fetchReplies, 500); // Poll for new replies every 5000 ms\n\n      return () => clearInterval(intervalId); // Cleanup interval on component unmount\n  }, [messageId, apiKey]); // Re-run effect if messageId or apiKey changes\n\n  const handleSubmit = async (e) => {\n      e.preventDefault();\n      if (!newReply.trim()) return;\n\n      try {\n          const response = await fetch(`/api/messages/${messageId}/replies`, {\n              method: 'POST',\n              headers: {\n                  'Content-Type': 'application/json',\n                  'API-Key': apiKey\n              },\n              body: JSON.stringify({ message: newReply }),\n          });\n\n          if (!response.ok) {\n              throw new Error('Failed to post reply');\n          }\n\n          setNewReply(''); // Clear the reply input field\n          fetchReplies(); // Fetch the latest replies after posting a new one\n\n      } catch (error) {\n          console.error('Error posting reply:', error);\n      }\n  };\n\n    return (\n      <div className=\"reply-list\">\n        <button className=\"close-btn\" onClick={onClose}>X</button>\n        <div className=\"parent-message\">\n          <strong>{parentMessage?.name}:</strong> {parentMessage?.body}\n        </div>\n        <div className=\"replies\">\n          {replies.length > 0 ? (\n            replies.map((reply, index) => (\n              <div key={index} className=\"reply\">\n                <strong>{reply.name}:</strong> {reply.body}\n              </div>\n            ))\n          ) : (\n            <p>No replies yet</p>\n          )}\n        </div>\n        <form onSubmit={handleSubmit} className=\"reply-form\">\n          <input\n            type=\"text\"\n            value={newReply}\n            onChange={(e) => setNewReply(e.target.value)}\n            placeholder=\"Write a reply...\"\n          />\n          <button type=\"submit\">Send</button>\n        </form>\n      </div>\n    );\n}\n\nexport default ReplyList;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEnD,QAAS,CAAAC,SAASA,CAAAC,IAAA,CAAyB,IAAxB,CAAEC,SAAS,CAAEC,OAAQ,CAAC,CAAAF,IAAA,CACvC,KAAM,CAACG,aAAa,CAAEC,gBAAgB,CAAC,CAAGX,QAAQ,CAAC,IAAI,CAAC,CACxD,KAAM,CAACY,OAAO,CAAEC,UAAU,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACc,QAAQ,CAAEC,WAAW,CAAC,CAAGf,QAAQ,CAAC,EAAE,CAAC,CAE5C,KAAM,CAAAgB,MAAM,CAAGC,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC,CAE9C;AACA,KAAM,CAAAC,YAAY,CAAGA,CAAA,GAAM,CACvB,GAAI,CAACX,SAAS,CAAE,OAEhBY,KAAK,kBAAAC,MAAA,CAAkBb,SAAS,aAAY,CACxCc,OAAO,CAAE,CACL,SAAS,CAAEN,MACf,CACJ,CAAC,CAAC,CACDO,IAAI,CAACC,QAAQ,EAAIA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACjCF,IAAI,CAACG,IAAI,EAAI,CACVf,gBAAgB,CAACe,IAAI,CAAChB,aAAa,CAAC,CACpCG,UAAU,CAACa,IAAI,CAACd,OAAO,CAAC,CAC5B,CAAC,CAAC,CACDe,KAAK,CAACC,KAAK,EAAIC,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAAC,CACpE,CAAC,CAED3B,SAAS,CAAC,IAAM,CACZkB,YAAY,CAAC,CAAC,CAAE;AAEhB,KAAM,CAAAW,UAAU,CAAGC,WAAW,CAACZ,YAAY,CAAE,GAAG,CAAC,CAAE;AAEnD,MAAO,IAAMa,aAAa,CAACF,UAAU,CAAC,CAAE;AAC5C,CAAC,CAAE,CAACtB,SAAS,CAAEQ,MAAM,CAAC,CAAC,CAAE;AAEzB,KAAM,CAAAiB,YAAY,CAAG,KAAO,CAAAC,CAAC,EAAK,CAC9BA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClB,GAAI,CAACrB,QAAQ,CAACsB,IAAI,CAAC,CAAC,CAAE,OAEtB,GAAI,CACA,KAAM,CAAAZ,QAAQ,CAAG,KAAM,CAAAJ,KAAK,kBAAAC,MAAA,CAAkBb,SAAS,aAAY,CAC/D6B,MAAM,CAAE,MAAM,CACdf,OAAO,CAAE,CACL,cAAc,CAAE,kBAAkB,CAClC,SAAS,CAAEN,MACf,CAAC,CACDsB,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEC,OAAO,CAAE3B,QAAS,CAAC,CAC9C,CAAC,CAAC,CAEF,GAAI,CAACU,QAAQ,CAACkB,EAAE,CAAE,CACd,KAAM,IAAI,CAAAC,KAAK,CAAC,sBAAsB,CAAC,CAC3C,CAEA5B,WAAW,CAAC,EAAE,CAAC,CAAE;AACjBI,YAAY,CAAC,CAAC,CAAE;AAEpB,CAAE,MAAOS,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAChD,CACJ,CAAC,CAEC,mBACEvB,KAAA,QAAKuC,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB1C,IAAA,WAAQyC,SAAS,CAAC,WAAW,CAACE,OAAO,CAAErC,OAAQ,CAAAoC,QAAA,CAAC,GAAC,CAAQ,CAAC,cAC1DxC,KAAA,QAAKuC,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BxC,KAAA,WAAAwC,QAAA,EAASnC,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEqC,IAAI,CAAC,GAAC,EAAQ,CAAC,IAAC,CAACrC,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAE4B,IAAI,EACzD,CAAC,cACNnC,IAAA,QAAKyC,SAAS,CAAC,SAAS,CAAAC,QAAA,CACrBjC,OAAO,CAACoC,MAAM,CAAG,CAAC,CACjBpC,OAAO,CAACqC,GAAG,CAAC,CAACC,KAAK,CAAEC,KAAK,gBACvB9C,KAAA,QAAiBuC,SAAS,CAAC,OAAO,CAAAC,QAAA,eAChCxC,KAAA,WAAAwC,QAAA,EAASK,KAAK,CAACH,IAAI,CAAC,GAAC,EAAQ,CAAC,IAAC,CAACG,KAAK,CAACZ,IAAI,GADlCa,KAEL,CACN,CAAC,cAEFhD,IAAA,MAAA0C,QAAA,CAAG,gBAAc,CAAG,CACrB,CACE,CAAC,cACNxC,KAAA,SAAM+C,QAAQ,CAAEnB,YAAa,CAACW,SAAS,CAAC,YAAY,CAAAC,QAAA,eAClD1C,IAAA,UACEkD,IAAI,CAAC,MAAM,CACXC,KAAK,CAAExC,QAAS,CAChByC,QAAQ,CAAGrB,CAAC,EAAKnB,WAAW,CAACmB,CAAC,CAACsB,MAAM,CAACF,KAAK,CAAE,CAC7CG,WAAW,CAAC,kBAAkB,CAC/B,CAAC,cACFtD,IAAA,WAAQkD,IAAI,CAAC,QAAQ,CAAAR,QAAA,CAAC,MAAI,CAAQ,CAAC,EAC/B,CAAC,EACJ,CAAC,CAEZ,CAEA,cAAe,CAAAvC,SAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}